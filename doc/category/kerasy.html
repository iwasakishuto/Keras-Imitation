<!doctype html>
<html class="no-js" lang="en">
    <head>
        <link rel="shortcut icon" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" />

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="author" content="Shuto" />
        <title>Kerasy</title>

        <meta name="description" content="Imitating to deepen my understanding of deep learning" />
        <meta name="keywords" content="Blog "/>

        <!--[if !IE 7]>
        <style type="text/css">
            #main-content {display:table;height:100%}
        </style>
        <![endif]-->
        <link rel="stylesheet" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/backdrop.css" />
        <link rel="stylesheet" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/pygments.css" />
        <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/modernizr.js"></script>

        <!-- Added by Shuto Iwasaki. -->
        <link rel="apple-touch-icon" sizes="152x152" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" type="image/png" />
        <!-- Custom CSS -->
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/custom.css" media="screen">
        <!-- Syntax highlight -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- LaTex -->
        <!-- Github env -->
        <!--<script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
        <script type="text/x-mathjax-config">
        	MathJax.Hub.Config({
        		tex2jax: {
        			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        			displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        		}
        	});
        </script>
        <script src="https://iwasakishuto.github.io/js/jquery.color.js"></script>
    </head>


    <body>
      <div class="master-row">

        <div class="image-pane main-content" style="background: url('https://iwasakishuto.github.io/Kerasy/doc/theme/img/background.png'); background-size:cover; background-position: right;">
          <div class="row">
            <div class="small-12 medium-4 large-12 columns">
              <h5 class='text-center'>About</h5>
              <div class="about-me">
                <div class="hide-for-medium-only small-3 columns no-buffer">
                  <a class="th" href="https://iwasakishuto.github.io/images/profile/square.png">
                    <img src="https://iwasakishuto.github.io/images/profile/square.png">
                  </a>
                </div>
                <div class="small-9 medium-12 large-9 columns text-justify">
                  Bioinformatics/Deep learning/Augmented Human/The University of Tokyo
                </div>
                <div class="small-12 columns">
                  <ul class="inline-center social-list">
                    <li><a href="https://twitter.com/cabernet_rock"><i class="fa fa-twitter"></i>&nbsp; twitter</a></li>
                    <li><a href="https://github.com/iwasakishuto"><i class="fa fa-github"></i>&nbsp; github</a></li>
                    <li><a href="https://www.facebook.com/iwasakishuto"><i class="fa fa-facebook"></i>&nbsp; facebook</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="small-12 medium-4  large-12 columns link-list">
              <h5 class='text-center'>Links</h5>
              <ul class="inline-center">
                <li><a href="https://iwasakishuto.github.io">Home</a></li>
                <li><a href="https://iwasakishuto.github.io/blog/articles/index.html">Blog</a></li>
                <li><a href="https://iwasakishuto.github.io/University/index.html">University</a></li>
                <li><a href="https://iwasakishuto.github.io/Kerasy/doc/index.html">Kerasy</a></li>
                <li><a href="https://iwasakishuto.github.io/Front-End/index.html">Front-End</a></li>
              </ul>
            </div>

<!--
            <div class="small-12 medium-3 large-12 columns">
            </div>
-->
          </div>
        </div>

        <div class="content-pane main-content">
          <nav class="top-bar" data-topbar role="navigation">
            <ul class="title-area">
              <li class="name"><!-- Leave this empty --></li>
              <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
            </ul>
            <section class="top-bar-section">
              <ul class="left">
              </ul>
              <ul class="right">
                <li class="active"><a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></li>
              </ul>
            </section>
          </nav>

          <div class="row title-bar">
            <div class="small-12 columns">
              <h1><a href="https://iwasakishuto.github.io/Kerasy/doc">Kerasy</a></h1>
              <h2> <small>Imitating to deepen my understanding of deep learning</small></h2>
              <hr>
            </div>
          </div>

          <div id="contents">
<div class="row">
    <div class="small-12 columns">
        <h2>Articles in category &ldquo;Kerasy&rdquo;</h2>
          <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/CNN.html" rel="bookmark" title="Permalink to CNN">CNN</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-30(Fri)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="CNN:-Convolutional-Neural-Network">CNN: Convolutional Neural Network<a class="anchor-link" href="#CNN:-Convolutional-Neural-Network">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/CNN.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>
  <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/Initializers.html" rel="bookmark" title="Permalink to Initializers">Initializers</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-28(Wed)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="初期化(Initializers)">初期化(Initializers)<a class="anchor-link" href="#初期化(Initializers)">¶</a></h1><p><strong>（編集中）</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/Initializers.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>
  <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/Optimizers.html" rel="bookmark" title="Permalink to Optimizers">Optimizers</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-26(Mon)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="最適化(Optimization)">最適化(Optimization)<a class="anchor-link" href="#最適化(Optimization)">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>機械学習では、モデルを定義し、重みパラメータを調整して損失関数の値を減少させることで、性能を高めます。</p>
<p>この時、<b>「いつ」</b>・<b>「どのようにして」</b>・<b>「どのぐらい」</b>重みパラメータを調整するのか、を決めるのが <code>optimizers</code> の役割です。</p>
<p>ここでは、最適化の基本である<span class="marker-pink">勾配降下法(Gradient Decent)</span>のパラメータ更新方法を見ていき、その後勾配降下法の欠点を修正した様々な最適化手法を紹介します。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="勾配降下法(Gradient-Decent)">勾配降下法(Gradient Decent)<a class="anchor-link" href="#勾配降下法(Gradient-Decent)">¶</a></h2><p><a href="http://www.deepideas.net/deep-learning-from-scratch-iv-gradient-descent-and-backpropagation/"><img src="http://www.deepideas.net/wp-content/uploads/2017/08/gradient_descent.png" /></a></p>
<p>勾配降下法は非常に単純なアイデアで、損失関数の<span class="marker-pink">勾配ベクトル（最も傾きが急な方向）</span>に注目し、その逆方向に進めば関数の最小値にたどり着くことができるだろう、というものです。</p>
<p>更新式は以下のようになります。</p>
$$\mathbf{w} \leftarrow \mathbf{w} - \eta \frac{\partial E}{\partial \mathbf{w}}$$<p>この時、$\eta$ は<span class="marker-pink">学習率</span>と呼ばれ、どの程度勾配を下るかを決めるパラメータです。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="$\eta$-と学習の関係">$\eta$ と学習の関係<a class="anchor-link" href="#$\eta$-と学習の関係">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$\eta$ の値を変化させた時にどのように値が変化するかを、二乗和誤差 $E(\mathbf{w}) = \left\|\mathbf{y} - \mathbf{X}\mathbf{w}\right\|^2$ に対する線形回帰の場合で見ていきます。</p>
<p>この時、損失関数の勾配ベクトルは以下によって求まります。</p>
$$
\begin{aligned}
  \frac{\partial}{\partial \mathbf{w}}E(\mathbf{w}) 
  &= \frac{\partial}{\partial \mathbf{w}}\left\|\mathbf{y} - \mathbf{X}\mathbf{w}\right\|^2\\
  &= \frac{\partial}{\partial \mathbf{w}}\left( \left\|\mathbf{y}\right\|^2 -2\mathbf{w}^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{y} + \|\mathbf{Xw}\|^2\right)\\
  &= -2\mathbf{X}^{\mathrm{T}}\mathbf{y} + \frac{\partial}{\partial \mathbf{w}}\left(\left(\mathbf{Xw}\right)^{\mathrm{T}}\left(\mathbf{Xw}\right)\right)\\
  &= -2\mathbf{X}^{\mathrm{T}}\mathbf{y} + \frac{\partial}{\partial \mathbf{w}}\left(\mathbf{w}^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Xw}\right)\\
  &= -2\mathbf{X}^{\mathrm{T}}\mathbf{y} + \left(\mathbf{X}^{\mathrm{T}}\mathbf{X} + \left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{\mathrm{T}}\right)\mathbf{w}\\
  &= 2\mathbf{X}^{\mathrm{T}}\left(\mathbf{Xw} - \mathbf{y}\right)
\end{aligned}
$$
</div>
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/Optimizers.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>
  <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/Computational-Graph.html" rel="bookmark" title="Permalink to Computational Graph">Computational Graph</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-23(Fri)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/deeplearningfromscratch.html"><span class="label">DeepLearningfromScratch</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="計算グラフ(Computational-Graph)">計算グラフ(Computational Graph)<a class="anchor-link" href="#計算グラフ(Computational-Graph)">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<ul>
<li>計算の過程をグラフによって表現したもの。<ul>
<li>ノード：<span aria-label="機械語の1個の命令の部分で、実行する操作(operation)の種類を指定する部分のこと、およびそのコード（符号）のこと。数式における演算子に相当する。" class="marker-info">オペコード</span></li>
<li>エッジ：<span aria-label="コンピュータの演算における値や変数のこと。オぺランドは演算の種類や内容を表す演算子（オペレータ）によって演算対象となるもので、例えば「7×3」という計算式があれば、「7」と「3」がオペランドとなる。" class="marker-info">オペランド</span></li>
</ul>
</li>
<li>途中の計算結果を全て保持できる。</li>
<li>局所的な計算を伝播することによって最終的な計算結果を得ることが可能であり、それによって<span class="marker-pink">問題を単純化して理解できる。</span></li>
<li>特に微分の計算は「計算の局所化」＝<span aria-label="ある関数が合成関数で表される場合、その合成関数の微分は合成関数を構成するそれぞれの関数の微分の積によって表すことができる。" class="marker-info">「連鎖律(chain rule)」</span>であり、相性が良い。</li>
</ul>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="計算グラフの逆伝播" src="theme/img/ComputationalGraph/BackPropagation.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="連鎖律と計算グラフ">連鎖律と計算グラフ<a class="anchor-link" href="#連鎖律と計算グラフ">¶</a></h2>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="連鎖律(chain-rule)">連鎖律(chain rule)<a class="anchor-link" href="#連鎖律(chain-rule)">¶</a></h3><p>ここでは例として $z=(x+y)^2$ という式を扱う。この式は、次の $2$ 式から構成されていると考えることができる。</p>
$$
\begin{cases}
  z = t^2\\
  t = x+y
\end{cases}
$$<p>この時、連鎖律から<b>「$x$ に関する $z$ の微分 $\frac{\partial z}{\partial x}$」</b>は<b>「$t$ に関する $z$ の微分 $\frac{\partial z}{\partial t}$」</b>と<b>「$x$ に関する $t$ の微分 $\frac{\partial t}{\partial x}$」</b>の積によって表すことができるので、以下のように書くことができる。</p>
$$
\frac{\partial z}{\partial x} = \frac{\partial z}{\partial t} \times \frac{\partial t}{\partial x}
$$
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="計算グラフ">計算グラフ<a class="anchor-link" href="#計算グラフ">¶</a></h3><p>上で数式的に考えた連鎖律の計算を計算グラフで表すと、以下のようになる。</p>
<p><img alt="連鎖律" src="theme/img/ComputationalGraph/ChainRule.png" /></p>
<p>これによって、局所的な微分計算の積によって合成関数の微分が行われていることが視覚的に理解できる。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="色々なノードにおける逆伝播">色々なノードにおける逆伝播<a class="anchor-link" href="#色々なノードにおける逆伝播">¶</a></h2><p>ここから、様々なオペコードにおける逆伝播を考える。</p>
<div class="frame">
<li><a href="#add">加算ノード</a></li>
<li><a href="#multiple">乗算ノード</a></li>
<li><a href="#inverse">逆数ノード</a></li>
<li><a href="#exp">expノード</a></li>
<li><a href="#dot">dotノード</a></li>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="add">加算ノード</h3><p>$z=x+y$ という数式を考えと、この式の微分は次のように計算できる。</p>
$$
\begin{cases}
  \begin{aligned}
    \frac{\partial z}{\partial x} = 1\\
    \frac{\partial z}{\partial y} = 1\\
  \end{aligned}
\end{cases}
$$<p>したがって、加算ノードの逆伝播は以下のように表される。</p>
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/Computational-Graph.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>
  <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/Neural-Network.html" rel="bookmark" title="Permalink to Neural Network">Neural Network</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-18(Sun)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/prml.html"><span class="label">prml</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Neural-Network">Neural Network<a class="anchor-link" href="#Neural-Network">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Table-of-contents">Table of contents<a class="anchor-link" href="#Table-of-contents">¶</a></h2><ol>
<li><a data-scroll="" href="#anchor1">単純パーセプロトン (Perceptron)</a></li>
<li><a data-scroll="" href="#anchor2">多層パーセプロトン (Multilayer Perceptron)</a></li>
<li><a data-scroll="" href="#anchor3">誤差逆伝播法 (Back Propagation)</a></li>
<li><a data-scroll="" href="#anchor4">実装 (Implementation)</a></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor1">1. 単純パーセプロトン (Perceptron)</h2><p>ニューラルネットワークは <strong>多数の素子（パーセプトロン）の集まり</strong> で表現されます。そこで、まずは１つ１つの素子、パーセプロトンを見ていきます。</p>
<p>単一の素子は以下の図のように表され、入力を受け取り、</p>
<ul>
<li><strong>その値（の和）がある閾値 $\theta$ を超えたら発火して出力</strong></li>
<li><strong>$\theta$ 以下だったら出力しない</strong></li>
</ul>
<p>という性質を持ちます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="Perceptron" src="theme/img/NeuralNetworks/Perceptron.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>この性質を数学的に記述すると、</p>
<ul>
<li>重みパラメータ：$w_0,w_1,\ldots,w_m$</li>
<li>活性化関数：$h$</li>
</ul>
<p>から構成される以下のような関数として書けます。</p>
$$f(x_1,x_2,\ldots,x_m) = h(w_1x_1+w_2x_2+\cdots+w_Nx_N+w_0)$$<p>この時 $w_0$ は<font color="red"><b>バイアスパラメータ(bias parameter)</b></font>と呼ばれ、<b>関数を平行移動させる</b>役割を果たします。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="活性化関数(activation-function)">活性化関数(activation function)<a class="anchor-link" href="#活性化関数(activation-function)">¶</a></h3><p>活性化関数は、<font color="red"><b>「ある閾値 $\theta$ を超えたら発火して出力し、$\theta$ 以下だったら出力しない」</b></font>という神経の性質を表現するための関数であり、最も単純なものとしては以下で表される<b>ヘヴィサイド関数(Heaviside function)</b>があります。</p>
$$h(a) = \left\{\begin{array}{cc}0 & (\theta < 0) \\1 & (\theta > 0)\end{array}\right.$$<p>この性質は表したい能力を如実に表してはいますが、<b>不連続であり扱いづらい</b>ため、実際は</p>
<ul>
<li><b>ロジスティックシグモイド関数</b>：
$$h(a) = \frac{1}{1+\exp(-a)}\qquad(4.59)$$</li>
<li><b>ハイパボリックタンジェント関数</b>：
$$\begin{aligned}h(a) &= \tanh (a)\\&=\frac{e^a-e^{-1}}{e^1+e^{-1}}
&(5.59)\end{aligned}$$</li>
<li><b>ソフトマックス関数</b>：
$$h(\mathbf{a}) = \frac{\exp(a_i)}{\sum_j \exp(a_i)}\qquad (4.63)$$</li>
</ul>
<p>などが用いられることが多いです。</p>
<p>※ Kerasyでは<a href="https://github.com/iwasakishuto/Kerasy/blob/gh-pages/kerasy/activations.py">ここ</a>で定義しています。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/Neural-Network.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>


    </div>
</div>
          </div>

          <footer class="show-for-large-up">
<div class="row">
    <div class="small-6 medium-3 columns">
        <ul class="left-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc">Home &nbsp;<i class="fa fa-home fa-fw"></i></a></li>
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/categories.html">Categories &nbsp;<i class="fa fa-folder-open fa-fw"></i></a></li>
        </ul>
    </div>
    <div class="small-6 medium-3 medium-push-6 columns">
        <ul class="right-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/archives.html"><i class="fa fa-archive fa-fw"></i>&nbsp; Archives</a></li>
        </ul>
    </div>
    <div class="small-12 medium-6 medium-pull-3 columns text-center">
        <p class="tag-cloud">
            <a href="https://iwasakishuto.github.io/Kerasy/doc/tags.html"><i class="fa fa-tags"></i>&nbsp;Tags:</a>&nbsp;&nbsp;
            &nbsp;&hellip;
        </p>
    </div>
    <div class="small-12 columns sub-footer">
        <hr>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-left">
                &copy; 2019 Shuto 
                <!-- <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="cc.png" /></a>-->
            </p>
        </div>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-right">
                Proudly powered by <a href="http://blog.getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
            </p>
        </div>
    </div>
</div>          </footer>
        </div>
      </div>


      <div class="row">
        <footer class="hide-for-large-up">
<div class="row">
    <div class="small-6 medium-3 columns">
        <ul class="left-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc">Home &nbsp;<i class="fa fa-home fa-fw"></i></a></li>
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/categories.html">Categories &nbsp;<i class="fa fa-folder-open fa-fw"></i></a></li>
        </ul>
    </div>
    <div class="small-6 medium-3 medium-push-6 columns">
        <ul class="right-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/archives.html"><i class="fa fa-archive fa-fw"></i>&nbsp; Archives</a></li>
        </ul>
    </div>
    <div class="small-12 medium-6 medium-pull-3 columns text-center">
        <p class="tag-cloud">
            <a href="https://iwasakishuto.github.io/Kerasy/doc/tags.html"><i class="fa fa-tags"></i>&nbsp;Tags:</a>&nbsp;&nbsp;
            &nbsp;&hellip;
        </p>
    </div>
    <div class="small-12 columns sub-footer">
        <hr>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-left">
                &copy; 2019 Shuto 
                <!-- <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="cc.png" /></a>-->
            </p>
        </div>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-right">
                Proudly powered by <a href="http://blog.getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
            </p>
        </div>
    </div>
</div>        </footer>
      </div>


      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/jquery.min.js"></script>
      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/foundation.min.js"></script>
      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/app.js"></script>
      <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
      <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/jupyter.css" media="screen">
    </body>

</html>