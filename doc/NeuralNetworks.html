<!doctype html>
<html class="no-js" lang="en">
    <head>
        <link rel="shortcut icon" href="https://iwasakishuto.github.io/Kerasy/doc/theme/img/apple-touch-icon-152x152.png" />

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="author" content="Shuto" />
        <title>NeuralNetworks</title>

<meta name="description" content="&lt;div class=&#34;cell border-box-sizing text_cell rendered&#34;&gt;&lt;div class=&#34;prompt input_prompt&#34;&gt;
&lt;/div&gt;&lt;div class=&#34;inner_cell&#34;&gt;
&lt;div class=&#34;text_cell_render border-box-sizing rendered_html&#34;&gt;
&lt;h1 id=&#34;Neural-Network&#34;&gt;Neural Network&lt;a class=&#34;anchor-link&#34; href=&#34;#Neural-Network&#34;&gt;¶&lt;/a&gt;&lt;/h1&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;cell border-box-sizing text_cell rendered&#34;&gt;&lt;div class=&#34;prompt input_prompt&#34;&gt;
&lt;/div&gt;&lt;div class=&#34;inner_cell&#34;&gt;
&lt;div class=&#34;text_cell_render border-box-sizing rendered_html&#34;&gt;
&lt;h2 id=&#34;Table-of-contents&#34;&gt;Table of contents&lt;a class=&#34;anchor-link&#34; href=&#34;#Table-of-contents&#34;&gt;¶&lt;/a&gt;&lt;/h2&gt;&lt;ol&gt;
&lt;li&gt;&lt;a data-scroll=&#34;&#34; href=&#34;#anchor1&#34;&gt;単純パーセプロトン (Perceptron)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a data-scroll=&#34;&#34; href=&#34;#anchor2&#34;&gt;多層パーセプロトン (Multilayer Perceptron)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a data-scroll=&#34;&#34; href=&#34;#anchor3&#34;&gt;誤差逆伝播法 (Back Propagation)&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a data-scroll=&#34;&#34; href=&#34;#anchor4&#34;&gt;実装 (Implementation)&lt;/a&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;cell border-box-sizing text_cell rendered&#34;&gt;&lt;div class=&#34;prompt input_prompt&#34;&gt;
&lt;/div&gt;&lt;div class=&#34;inner_cell&#34;&gt;
&lt;div class=&#34;text_cell_render border-box-sizing rendered_html&#34;&gt;
&lt;h2 id=&#34;anchor1&#34;&gt;1. 単純パーセプロトン (Perceptron)&lt;/h2&gt;&lt;p&gt;ニューラルネットワークは &lt;strong&gt;多数の素子（パーセプトロン）の集まり&lt;/strong&gt; で表現されます。そこで、まずは１つ１つの素子、パーセプロトンを見ていきます。&lt;/p&gt;
&lt;p&gt;単一の素子は以下の図のように表され、入力を受け取り、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;その値（の和）がある閾値 $\theta$ を超えたら発火して出力&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;$\theta$ 以下だったら出力しない&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;という性質を持ちます。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;cell border-box-sizing text_cell rendered&#34;&gt;&lt;div class=&#34;prompt input_prompt&#34;&gt;
&lt;/div&gt;&lt;div class=&#34;inner_cell&#34;&gt;
&lt;div class=&#34;text_cell_render border-box-sizing rendered_html&#34;&gt;
&lt;p&gt;&lt;img alt=&#34;Perceptron&#34; src=&#34;theme/img/NeuralNetworks/Perceptron.png&#34; /&gt;&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;cell border-box-sizing text_cell rendered&#34;&gt;&lt;div class=&#34;prompt input_prompt&#34;&gt;
&lt;/div&gt;&lt;div class=&#34;inner_cell&#34;&gt;
&lt;div class=&#34;text_cell_render border-box-sizing rendered_html&#34;&gt;
&lt;p&gt;この性質を数学的に記述すると、&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;重みパラメータ：$w_0,w_1,\ldots,w_m$&lt;/li&gt;
&lt;li&gt;活性化関数：$h$&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;から構成される以下のような関数として書けます。&lt;/p&gt;
$$f(x_1,x_2,\ldots,x_m) = h(w_1x_1+w_2x_2+\cdots+w_Nx_N+w_0)$$&lt;p&gt;この時 $w_0$ は&lt;font color=&#34;red&#34;&gt;&lt;b&gt;バイアスパラメータ(bias parameter)&lt;/b&gt;&lt;/font&gt;と呼ばれ、&lt;b&gt;関数を平行移動させる&lt;/b&gt;役割を果たします。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;cell border-box-sizing text_cell rendered&#34;&gt;&lt;div class=&#34;prompt input_prompt&#34;&gt;
&lt;/div&gt;&lt;div class=&#34;inner_cell&#34;&gt;
&lt;div class=&#34;text_cell_render border-box-sizing rendered_html&#34;&gt;
&lt;h3 id=&#34;活性化関数(activation-function)&#34;&gt;活性化関数(activation function)&lt;a class=&#34;anchor-link&#34; href=&#34;#活性化関数(activation-function)&#34;&gt;¶&lt;/a&gt;&lt;/h3&gt;&lt;p&gt;活性化関数は、&lt;font color=&#34;red&#34;&gt;&lt;b&gt;「ある閾値 $\theta$ を超えたら発火して出力し、$\theta$ 以下だったら出力しない」&lt;/b&gt;&lt;/font&gt;という神経の性質を表現するための関数であり、最も単純なものとしては以下で表される&lt;b&gt;ヘヴィサイド関数(Heaviside function)&lt;/b&gt;があります。&lt;/p&gt;
$$h(a) = \left\{\begin{array}{cc}0 &amp; (\theta &lt; 0) \\1 &amp; (\theta &gt; 0)\end{array}\right.$$&lt;p&gt;この性質は表したい能力を如実に表してはいますが、&lt;b&gt;不連続であり扱いづらい&lt;/b&gt;ため、実際は&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;b&gt;ロジスティックシグモイド関数&lt;/b&gt;：
$$h(a) = \frac{1}{1+\exp(-a)}\qquad(4.59)$$&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ハイパボリックタンジェント関数&lt;/b&gt;：
$$\begin{aligned}h(a) &amp;= \tanh (a)\\&amp;=\frac{e^a-e^{-1}}{e^1+e^{-1}}
&amp;(5.59)\end{aligned}$$&lt;/li&gt;
&lt;li&gt;&lt;b&gt;ソフトマックス関数&lt;/b&gt;：
$$h(\mathbf{a}) = \frac{\exp(a_i)}{\sum_j \exp(a_i)}\qquad (4.63)$$&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;などが用いられることが多いです。&lt;/p&gt;
&lt;p&gt;※ Kerasyでは&lt;a href=&#34;https://github.com/iwasakishuto/Kerasy/blob/gh-pages/kerasy/activations.py&#34;&gt;ここ&lt;/a&gt;で定義しています。&lt;/p&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;cell border-box-sizing code_cell rendered&#34;&gt;
&lt;div class=&#34;input&#34;&gt;" />
<meta name="keywords" content=" Kerasy prml  "/>

        <!--[if !IE 7]>
        <style type="text/css">
            #main-content {display:table;height:100%}
        </style>
        <![endif]-->
        <link rel="stylesheet" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/backdrop.css" />
        <link rel="stylesheet" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/pygments.css" />
        <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/modernizr.js"></script>

        <!-- Added by Shuto Iwasaki. -->
        <!-- Custom CSS -->
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/custom.css" media="screen">
        <!-- Syntax highlight -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- LaTex -->
        <!-- Github env -->
        <!--<script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
        <script type="text/x-mathjax-config">
        	MathJax.Hub.Config({
        		tex2jax: {
        			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        			displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        		}
        	});
        </script>
        <script src="https://iwasakishuto.github.io/js/jquery.color.js"></script>
    </head>


    <body>
      <div class="master-row">

        <div class="image-pane main-content" style="background: url('https://iwasakishuto.github.io/Kerasy/doc/theme/img/background.png'); background-size:cover; background-position: right;">
          <div class="row">
            <div class="small-12 medium-4 large-12 columns">
              <h5 class='text-center'>About</h5>
              <div class="about-me">
                <div class="hide-for-medium-only small-3 columns no-buffer">
                  <a class="th" href="https://iwasakishuto.github.io/Kerasy/doc/theme/img/profile.png">
                    <img src="https://iwasakishuto.github.io/Kerasy/doc/theme/img/profile.png">
                  </a>
                </div>
                <div class="small-9 medium-12 large-9 columns text-justify">
                  Bioinformatics/Deep learning/Augmented Human/The University of Tokyo
                </div>
                <div class="small-12 columns">
                  <ul class="inline-center social-list">
                    <li><a href="https://twitter.com/cabernet_rock"><i class="fa fa-twitter"></i>&nbsp; twitter</a></li>
                    <li><a href="https://github.com/iwasakishuto"><i class="fa fa-github"></i>&nbsp; github</a></li>
                    <li><a href="https://www.facebook.com/iwasakishuto"><i class="fa fa-facebook"></i>&nbsp; facebook</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="small-12 medium-4  large-12 columns link-list">
              <h5 class='text-center'>Links</h5>
              <ul class="inline-center">
                <li><a href="https://iwasakishuto.github.io">Home</a></li>
                <li><a href="https://iwasakishuto.github.io/blog/articles/index.html">Blog</a></li>
                <li><a href="https://iwasakishuto.github.io/University/notes/index.html">Notes</a></li>
                <li><a href="https://iwasakishuto.github.io/kerasy/doc/index.html">Kerasy</a></li>
              </ul>
            </div>

<!--
            <div class="small-12 medium-3 large-12 columns">
            </div>
-->
          </div>
        </div>

        <div class="content-pane main-content">
          <nav class="top-bar" data-topbar role="navigation">
            <ul class="title-area">
              <li class="name"><!-- Leave this empty --></li>
              <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
            </ul>
            <section class="top-bar-section">
              <ul class="left">
              </ul>
              <ul class="right">
                <li class="active"><a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></li>
              </ul>
            </section>
          </nav>

          <div class="row title-bar">
            <div class="small-12 columns">
              <h1><a href="https://iwasakishuto.github.io/Kerasy/doc">Kerasy</a></h1>
              <h2> <small>Imitating to deepen my understanding of deep learning</small></h2>
              <hr>
            </div>
          </div>

          <div id="contents">
<div class="row">
    <div class="small-12 columns article">
        <h2>NeuralNetworks</h2>
        <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-18(日)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/prml.html"><span class="label">prml</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
        <section class="article">
            <style type="text/css">/*!
*
* IPython notebook
*
*/
/* CSS font colors for translated ANSI escape sequences */
/* The color values are a mix of
   http://www.xcolors.net/dl/baskerville-ivorylight and
   http://www.xcolors.net/dl/euphrasia */
.ansi-black-fg {
  color: #3E424D;
}
.ansi-black-bg {
  background-color: #3E424D;
}
.ansi-black-intense-fg {
  color: #282C36;
}
.ansi-black-intense-bg {
  background-color: #282C36;
}
.ansi-red-fg {
  color: #E75C58;
}
.ansi-red-bg {
  background-color: #E75C58;
}
.ansi-red-intense-fg {
  color: #B22B31;
}
.ansi-red-intense-bg {
  background-color: #B22B31;
}
.ansi-green-fg {
  color: #00A250;
}
.ansi-green-bg {
  background-color: #00A250;
}
.ansi-green-intense-fg {
  color: #007427;
}
.ansi-green-intense-bg {
  background-color: #007427;
}
.ansi-yellow-fg {
  color: #DDB62B;
}
.ansi-yellow-bg {
  background-color: #DDB62B;
}
.ansi-yellow-intense-fg {
  color: #B27D12;
}
.ansi-yellow-intense-bg {
  background-color: #B27D12;
}
.ansi-blue-fg {
  color: #208FFB;
}
.ansi-blue-bg {
  background-color: #208FFB;
}
.ansi-blue-intense-fg {
  color: #0065CA;
}
.ansi-blue-intense-bg {
  background-color: #0065CA;
}
.ansi-magenta-fg {
  color: #D160C4;
}
.ansi-magenta-bg {
  background-color: #D160C4;
}
.ansi-magenta-intense-fg {
  color: #A03196;
}
.ansi-magenta-intense-bg {
  background-color: #A03196;
}
.ansi-cyan-fg {
  color: #60C6C8;
}
.ansi-cyan-bg {
  background-color: #60C6C8;
}
.ansi-cyan-intense-fg {
  color: #258F8F;
}
.ansi-cyan-intense-bg {
  background-color: #258F8F;
}
.ansi-white-fg {
  color: #C5C1B4;
}
.ansi-white-bg {
  background-color: #C5C1B4;
}
.ansi-white-intense-fg {
  color: #A1A6B2;
}
.ansi-white-intense-bg {
  background-color: #A1A6B2;
}
.ansi-default-inverse-fg {
  color: #FFFFFF;
}
.ansi-default-inverse-bg {
  background-color: #000000;
}
.ansi-bold {
  font-weight: bold;
}
.ansi-underline {
  text-decoration: underline;
}
/* The following styles are deprecated an will be removed in a future version */
.ansibold {
  font-weight: bold;
}
.ansi-inverse {
  outline: 0.5px dotted;
}
/* use dark versions for foreground, to improve visibility */
.ansiblack {
  color: black;
}
.ansired {
  color: darkred;
}
.ansigreen {
  color: darkgreen;
}
.ansiyellow {
  color: #c4a000;
}
.ansiblue {
  color: darkblue;
}
.ansipurple {
  color: darkviolet;
}
.ansicyan {
  color: steelblue;
}
.ansigray {
  color: gray;
}
/* and light for background, for the same reason */
.ansibgblack {
  background-color: black;
}
.ansibgred {
  background-color: red;
}
.ansibggreen {
  background-color: green;
}
.ansibgyellow {
  background-color: yellow;
}
.ansibgblue {
  background-color: blue;
}
.ansibgpurple {
  background-color: magenta;
}
.ansibgcyan {
  background-color: cyan;
}
.ansibggray {
  background-color: gray;
}
div.cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  border-radius: 2px;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
  border-width: 1px;
  border-style: solid;
  border-color: transparent;
  width: 100%;
  padding: 5px;
  /* This acts as a spacer between cells, that is outside the border */
  margin: 0px;
  outline: none;
  position: relative;
  overflow: visible;
}
div.cell:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: transparent;
}
div.cell.jupyter-soft-selected {
  border-left-color: #E3F2FD;
  border-left-width: 1px;
  padding-left: 5px;
  border-right-color: #E3F2FD;
  border-right-width: 1px;
  background: #E3F2FD;
}
@media print {
  div.cell.jupyter-soft-selected {
    border-color: transparent;
  }
}
div.cell.selected,
div.cell.selected.jupyter-soft-selected {
  border-color: #ababab;
}
div.cell.selected:before,
div.cell.selected.jupyter-soft-selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #42A5F5;
}
@media print {
  div.cell.selected,
  div.cell.selected.jupyter-soft-selected {
    border-color: transparent;
  }
}
.edit_mode div.cell.selected {
  border-color: #66BB6A;
}
.edit_mode div.cell.selected:before {
  position: absolute;
  display: block;
  top: -1px;
  left: -1px;
  width: 5px;
  height: calc(100% +  2px);
  content: '';
  background: #66BB6A;
}
@media print {
  .edit_mode div.cell.selected {
    border-color: transparent;
  }
}
.prompt {
  /* This needs to be wide enough for 3 digit prompt numbers: In[100]: */
  min-width: 14ex;
  /* This padding is tuned to match the padding on the CodeMirror editor. */
  padding: 0.4em;
  margin: 0px;
  font-family: monospace;
  text-align: right;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
  /* Don't highlight prompt number selection */
  -webkit-touch-callout: none;
  -webkit-user-select: none;
  -khtml-user-select: none;
  -moz-user-select: none;
  -ms-user-select: none;
  user-select: none;
  /* Use default cursor */
  cursor: default;
}
@media (max-width: 540px) {
  .prompt {
    text-align: left;
  }
}
div.inner_cell {
  min-width: 0;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_area {
  border: 1px solid #cfcfcf;
  border-radius: 2px;
  background: #f7f7f7;
  line-height: 1.21429em;
}
/* This is needed so that empty prompt areas can collapse to zero height when there
   is no content in the output_subarea and the prompt. The main purpose of this is
   to make sure that empty JavaScript output_subareas have no height. */
div.prompt:empty {
  padding-top: 0;
  padding-bottom: 0;
}
div.unrecognized_cell {
  padding: 5px 5px 5px 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.unrecognized_cell .inner_cell {
  border-radius: 2px;
  padding: 5px;
  font-weight: bold;
  color: red;
  border: 1px solid #cfcfcf;
  background: #eaeaea;
}
div.unrecognized_cell .inner_cell a {
  color: inherit;
  text-decoration: none;
}
div.unrecognized_cell .inner_cell a:hover {
  color: inherit;
  text-decoration: none;
}
@media (max-width: 540px) {
  div.unrecognized_cell > div.prompt {
    display: none;
  }
}
div.code_cell {
  /* avoid page breaking on code cells when printing */
}
@media print {
  div.code_cell {
    page-break-inside: avoid;
  }
}
/* any special styling for code cells that are currently running goes here */
div.input {
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.input {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
/* input_area and input_prompt must match in top border and margin for alignment */
div.input_prompt {
  color: #303F9F;
  border-top: 1px solid transparent;
}
div.input_area > div.highlight {
  margin: 0.4em;
  border: none;
  padding: 0px;
  background-color: transparent;
}
div.input_area > div.highlight > pre {
  margin: 0px;
  border: none;
  padding: 0px;
  background-color: transparent;
}
/* The following gets added to the <head> if it is detected that the user has a
 * monospace font with inconsistent normal/bold/italic height.  See
 * notebookmain.js.  Such fonts will have keywords vertically offset with
 * respect to the rest of the text.  The user should select a better font.
 * See: https://github.com/ipython/ipython/issues/1503
 *
 * .CodeMirror span {
 *      vertical-align: bottom;
 * }
 */
.CodeMirror {
  line-height: 1.21429em;
  /* Changed from 1em to our global default */
  font-size: 14px;
  height: auto;
  /* Changed to auto to autogrow */
  background: none;
  /* Changed from white to allow our bg to show through */
}
.CodeMirror-scroll {
  /*  The CodeMirror docs are a bit fuzzy on if overflow-y should be hidden or visible.*/
  /*  We have found that if it is visible, vertical scrollbars appear with font size changes.*/
  overflow-y: hidden;
  overflow-x: auto;
}
.CodeMirror-lines {
  /* In CM2, this used to be 0.4em, but in CM3 it went to 4px. We need the em value because */
  /* we have set a different line-height and want this to scale with that. */
  /* Note that this should set vertical padding only, since CodeMirror assumes
       that horizontal padding will be set on CodeMirror pre */
  padding: 0.4em 0;
}
.CodeMirror-linenumber {
  padding: 0 8px 0 4px;
}
.CodeMirror-gutters {
  border-bottom-left-radius: 2px;
  border-top-left-radius: 2px;
}
.CodeMirror pre {
  /* In CM3 this went to 4px from 0 in CM2. This sets horizontal padding only,
    use .CodeMirror-lines for vertical */
  padding: 0 0.4em;
  border: 0;
  border-radius: 0;
}
.CodeMirror-cursor {
  border-left: 1.4px solid black;
}
@media screen and (min-width: 2138px) and (max-width: 4319px) {
  .CodeMirror-cursor {
    border-left: 2px solid black;
  }
}
@media screen and (min-width: 4320px) {
  .CodeMirror-cursor {
    border-left: 4px solid black;
  }
}
/*

Original style from softwaremaniacs.org (c) Ivan Sagalaev <Maniac@SoftwareManiacs.Org>
Adapted from GitHub theme

*/
.highlight-base {
  color: #000;
}
.highlight-variable {
  color: #000;
}
.highlight-variable-2 {
  color: #1a1a1a;
}
.highlight-variable-3 {
  color: #333333;
}
.highlight-string {
  color: #BA2121;
}
.highlight-comment {
  color: #408080;
  font-style: italic;
}
.highlight-number {
  color: #080;
}
.highlight-atom {
  color: #88F;
}
.highlight-keyword {
  color: #008000;
  font-weight: bold;
}
.highlight-builtin {
  color: #008000;
}
.highlight-error {
  color: #f00;
}
.highlight-operator {
  color: #AA22FF;
  font-weight: bold;
}
.highlight-meta {
  color: #AA22FF;
}
/* previously not defined, copying from default codemirror */
.highlight-def {
  color: #00f;
}
.highlight-string-2 {
  color: #f50;
}
.highlight-qualifier {
  color: #555;
}
.highlight-bracket {
  color: #997;
}
.highlight-tag {
  color: #170;
}
.highlight-attribute {
  color: #00c;
}
.highlight-header {
  color: blue;
}
.highlight-quote {
  color: #090;
}
.highlight-link {
  color: #00c;
}
/* apply the same style to codemirror */
.cm-s-ipython span.cm-keyword {
  color: #008000;
  font-weight: bold;
}
.cm-s-ipython span.cm-atom {
  color: #88F;
}
.cm-s-ipython span.cm-number {
  color: #080;
}
.cm-s-ipython span.cm-def {
  color: #00f;
}
.cm-s-ipython span.cm-variable {
  color: #000;
}
.cm-s-ipython span.cm-operator {
  color: #AA22FF;
  font-weight: bold;
}
.cm-s-ipython span.cm-variable-2 {
  color: #1a1a1a;
}
.cm-s-ipython span.cm-variable-3 {
  color: #333333;
}
.cm-s-ipython span.cm-comment {
  color: #408080;
  font-style: italic;
}
.cm-s-ipython span.cm-string {
  color: #BA2121;
}
.cm-s-ipython span.cm-string-2 {
  color: #f50;
}
.cm-s-ipython span.cm-meta {
  color: #AA22FF;
}
.cm-s-ipython span.cm-qualifier {
  color: #555;
}
.cm-s-ipython span.cm-builtin {
  color: #008000;
}
.cm-s-ipython span.cm-bracket {
  color: #997;
}
.cm-s-ipython span.cm-tag {
  color: #170;
}
.cm-s-ipython span.cm-attribute {
  color: #00c;
}
.cm-s-ipython span.cm-header {
  color: blue;
}
.cm-s-ipython span.cm-quote {
  color: #090;
}
.cm-s-ipython span.cm-link {
  color: #00c;
}
.cm-s-ipython span.cm-error {
  color: #f00;
}
.cm-s-ipython span.cm-tab {
  background: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAMCAYAAAAkuj5RAAAAAXNSR0IArs4c6QAAAGFJREFUSMft1LsRQFAQheHPowAKoACx3IgEKtaEHujDjORSgWTH/ZOdnZOcM/sgk/kFFWY0qV8foQwS4MKBCS3qR6ixBJvElOobYAtivseIE120FaowJPN75GMu8j/LfMwNjh4HUpwg4LUAAAAASUVORK5CYII=);
  background-position: right;
  background-repeat: no-repeat;
}
div.output_wrapper {
  /* this position must be relative to enable descendents to be absolute within it */
  position: relative;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
  z-index: 1;
}
/* class for the output area when it should be height-limited */
div.output_scroll {
  /* ideally, this would be max-height, but FF barfs all over that */
  height: 24em;
  /* FF needs this *and the wrapper* to specify full width, or it will shrinkwrap */
  width: 100%;
  overflow: auto;
  border-radius: 2px;
  -webkit-box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  box-shadow: inset 0 2px 8px rgba(0, 0, 0, 0.8);
  display: block;
}
/* output div while it is collapsed */
div.output_collapsed {
  margin: 0px;
  padding: 0px;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
div.out_prompt_overlay {
  height: 100%;
  padding: 0px 0.4em;
  position: absolute;
  border-radius: 2px;
}
div.out_prompt_overlay:hover {
  /* use inner shadow to get border that is computed the same on WebKit/FF */
  -webkit-box-shadow: inset 0 0 1px #000;
  box-shadow: inset 0 0 1px #000;
  background: rgba(240, 240, 240, 0.5);
}
div.output_prompt {
  color: #D84315;
}
/* This class is the outer container of all output sections. */
div.output_area {
  padding: 0px;
  page-break-inside: avoid;
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
div.output_area .MathJax_Display {
  text-align: left !important;
}
div.output_area 
div.output_area 
div.output_area img,
div.output_area svg {
  max-width: 100%;
  height: auto;
}
div.output_area img.unconfined,
div.output_area svg.unconfined {
  max-width: none;
}
div.output_area .mglyph > img {
  max-width: none;
}
/* This is needed to protect the pre formating from global settings such
   as that of bootstrap */
.output {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: vertical;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: vertical;
  -moz-box-align: stretch;
  display: box;
  box-orient: vertical;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: column;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.output_area {
    /* Old browsers */
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-box-align: stretch;
    display: -moz-box;
    -moz-box-orient: vertical;
    -moz-box-align: stretch;
    display: box;
    box-orient: vertical;
    box-align: stretch;
    /* Modern browsers */
    display: flex;
    flex-direction: column;
    align-items: stretch;
  }
}
div.output_area pre {
  margin: 0;
  padding: 1px 0 1px 0;
  border: 0;
  vertical-align: baseline;
  color: black;
  background-color: transparent;
  border-radius: 0;
}
/* This class is for the output subarea inside the output_area and after
   the prompt div. */
div.output_subarea {
  overflow-x: auto;
  padding: 0.4em;
  /* Old browsers */
  -webkit-box-flex: 1;
  -moz-box-flex: 1;
  box-flex: 1;
  /* Modern browsers */
  flex: 1;
  max-width: calc(100% - 14ex);
}
div.output_scroll div.output_subarea {
  overflow-x: visible;
}
/* The rest of the output_* classes are for special styling of the different
   output types */
/* all text output has this class: */
div.output_text {
  text-align: left;
  color: #000;
  /* This has to match that of the the CodeMirror class line-height below */
  line-height: 1.21429em;
}
/* stdout/stderr are 'text' as well as 'stream', but execute_result/error are *not* streams */
div.output_stderr {
  background: #fdd;
  /* very light red background for stderr */
}
div.output_latex {
  text-align: left;
}
/* Empty output_javascript divs should have no height */
div.output_javascript:empty {
  padding: 0;
}
.js-error {
  color: darkred;
}
/* raw_input styles */
div.raw_input_container {
  line-height: 1.21429em;
  padding-top: 5px;
}
pre.raw_input_prompt {
  /* nothing needed here. */
}
input.raw_input {
  font-family: monospace;
  font-size: inherit;
  color: inherit;
  width: auto;
  /* make sure input baseline aligns with prompt */
  vertical-align: baseline;
  /* padding + margin = 0.5em between prompt and cursor */
  padding: 0em 0.25em;
  margin: 0em 0.25em;
}
input.raw_input:focus {
  box-shadow: none;
}
p.p-space {
  margin-bottom: 10px;
}
div.output_unrecognized {
  padding: 5px;
  font-weight: bold;
  color: red;
}
div.output_unrecognized a {
  color: inherit;
  text-decoration: none;
}
div.output_unrecognized a:hover {
  color: inherit;
  text-decoration: none;
}
.rendered_html {
  color: #000;
  /* any extras will just be numbers: */
}



.rendered_html :link {
  text-decoration: underline;
}
.rendered_html :visited {
  text-decoration: underline;
}






.rendered_html h1:first-child {
  margin-top: 0.538em;
}
.rendered_html h2:first-child {
  margin-top: 0.636em;
}
.rendered_html h3:first-child {
  margin-top: 0.777em;
}
.rendered_html h4:first-child {
  margin-top: 1em;
}
.rendered_html h5:first-child {
  margin-top: 1em;
}
.rendered_html h6:first-child {
  margin-top: 1em;
}
.rendered_html ul:not(.list-inline),
.rendered_html ol:not(.list-inline) {
  padding-left: 2em;
}








.rendered_html * + ul {
  margin-top: 1em;
}
.rendered_html * + ol {
  margin-top: 1em;
}





.rendered_html pre,




.rendered_html tr,
.rendered_html th,


.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}
.rendered_html * + table {
  margin-top: 1em;
}

.rendered_html * + p {
  margin-top: 1em;
}

.rendered_html * + img {
  margin-top: 1em;
}
.rendered_html img,

.rendered_html img.unconfined,


.rendered_html * + .alert {
  margin-top: 1em;
}
[dir="rtl"] 
div.text_cell {
  /* Old browsers */
  display: -webkit-box;
  -webkit-box-orient: horizontal;
  -webkit-box-align: stretch;
  display: -moz-box;
  -moz-box-orient: horizontal;
  -moz-box-align: stretch;
  display: box;
  box-orient: horizontal;
  box-align: stretch;
  /* Modern browsers */
  display: flex;
  flex-direction: row;
  align-items: stretch;
}
@media (max-width: 540px) {
  div.text_cell > div.prompt {
    display: none;
  }
}
div.text_cell_render {
  /*font-family: "Helvetica Neue", Arial, Helvetica, Geneva, sans-serif;*/
  outline: none;
  resize: none;
  width: inherit;
  border-style: none;
  padding: 0.5em 0.5em 0.5em 0.4em;
  color: #000;
  box-sizing: border-box;
  -moz-box-sizing: border-box;
  -webkit-box-sizing: border-box;
}
a.anchor-link:link {
  text-decoration: none;
  padding: 0px 20px;
  visibility: hidden;
}
h1:hover .anchor-link,
h2:hover .anchor-link,
h3:hover .anchor-link,
h4:hover .anchor-link,
h5:hover .anchor-link,
h6:hover .anchor-link {
  visibility: visible;
}
.text_cell.rendered .input_area {
  display: none;
}
.text_cell.rendered 
.text_cell.rendered .rendered_html tr,
.text_cell.rendered .rendered_html th,
.text_cell.rendered 
.text_cell.unrendered .text_cell_render {
  display: none;
}
.text_cell .dropzone .input_area {
  border: 2px dashed #bababa;
  margin: -1px;
}
.cm-header-1,
.cm-header-2,
.cm-header-3,
.cm-header-4,
.cm-header-5,
.cm-header-6 {
  font-weight: bold;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
}
.cm-header-1 {
  font-size: 185.7%;
}
.cm-header-2 {
  font-size: 157.1%;
}
.cm-header-3 {
  font-size: 128.6%;
}
.cm-header-4 {
  font-size: 110%;
}
.cm-header-5 {
  font-size: 100%;
  font-style: italic;
}
.cm-header-6 {
  font-size: 100%;
  font-style: italic;
}
</style>
<style type="text/css">.highlight .hll { background-color: #ffffcc }
.highlight  { background: #f8f8f8; }
.highlight .c { color: #408080; font-style: italic } /* Comment */
.highlight .err { border: 1px solid #FF0000 } /* Error */
.highlight .k { color: #008000; font-weight: bold } /* Keyword */
.highlight .o { color: #666666 } /* Operator */
.highlight .ch { color: #408080; font-style: italic } /* Comment.Hashbang */
.highlight .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.highlight .cp { color: #BC7A00 } /* Comment.Preproc */
.highlight .cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
.highlight .c1 { color: #408080; font-style: italic } /* Comment.Single */
.highlight .cs { color: #408080; font-style: italic } /* Comment.Special */
.highlight .gd { color: #A00000 } /* Generic.Deleted */
.highlight .ge { font-style: italic } /* Generic.Emph */
.highlight .gr { color: #FF0000 } /* Generic.Error */
.highlight .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.highlight .gi { color: #00A000 } /* Generic.Inserted */
.highlight .go { color: #888888 } /* Generic.Output */
.highlight .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.highlight .gs { font-weight: bold } /* Generic.Strong */
.highlight .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.highlight .gt { color: #0044DD } /* Generic.Traceback */
.highlight .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.highlight .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.highlight .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.highlight .kp { color: #008000 } /* Keyword.Pseudo */
.highlight .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.highlight .kt { color: #B00040 } /* Keyword.Type */
.highlight .m { color: #666666 } /* Literal.Number */
.highlight .s { color: #BA2121 } /* Literal.String */
.highlight .na { color: #7D9029 } /* Name.Attribute */
.highlight .nb { color: #008000 } /* Name.Builtin */
.highlight .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.highlight .no { color: #880000 } /* Name.Constant */
.highlight .nd { color: #AA22FF } /* Name.Decorator */
.highlight .ni { color: #999999; font-weight: bold } /* Name.Entity */
.highlight .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.highlight .nf { color: #0000FF } /* Name.Function */
.highlight .nl { color: #A0A000 } /* Name.Label */
.highlight .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.highlight .nt { color: #008000; font-weight: bold } /* Name.Tag */
.highlight .nv { color: #19177C } /* Name.Variable */
.highlight .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.highlight .w { color: #bbbbbb } /* Text.Whitespace */
.highlight .mb { color: #666666 } /* Literal.Number.Bin */
.highlight .mf { color: #666666 } /* Literal.Number.Float */
.highlight .mh { color: #666666 } /* Literal.Number.Hex */
.highlight .mi { color: #666666 } /* Literal.Number.Integer */
.highlight .mo { color: #666666 } /* Literal.Number.Oct */
.highlight .sa { color: #BA2121 } /* Literal.String.Affix */
.highlight .sb { color: #BA2121 } /* Literal.String.Backtick */
.highlight .sc { color: #BA2121 } /* Literal.String.Char */
.highlight .dl { color: #BA2121 } /* Literal.String.Delimiter */
.highlight .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.highlight .s2 { color: #BA2121 } /* Literal.String.Double */
.highlight .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.highlight .sh { color: #BA2121 } /* Literal.String.Heredoc */
.highlight .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.highlight .sx { color: #008000 } /* Literal.String.Other */
.highlight .sr { color: #BB6688 } /* Literal.String.Regex */
.highlight .s1 { color: #BA2121 } /* Literal.String.Single */
.highlight .ss { color: #19177C } /* Literal.String.Symbol */
.highlight .bp { color: #008000 } /* Name.Builtin.Pseudo */
.highlight .fm { color: #0000FF } /* Name.Function.Magic */
.highlight .vc { color: #19177C } /* Name.Variable.Class */
.highlight .vg { color: #19177C } /* Name.Variable.Global */
.highlight .vi { color: #19177C } /* Name.Variable.Instance */
.highlight .vm { color: #19177C } /* Name.Variable.Magic */
.highlight .il { color: #666666 } /* Literal.Number.Integer.Long */</style><div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Neural-Network">Neural Network<a class="anchor-link" href="#Neural-Network">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Table-of-contents">Table of contents<a class="anchor-link" href="#Table-of-contents">¶</a></h2><ol>
<li><a data-scroll="" href="#anchor1">単純パーセプロトン (Perceptron)</a></li>
<li><a data-scroll="" href="#anchor2">多層パーセプロトン (Multilayer Perceptron)</a></li>
<li><a data-scroll="" href="#anchor3">誤差逆伝播法 (Back Propagation)</a></li>
<li><a data-scroll="" href="#anchor4">実装 (Implementation)</a></li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor1">1. 単純パーセプロトン (Perceptron)</h2><p>ニューラルネットワークは <strong>多数の素子（パーセプトロン）の集まり</strong> で表現されます。そこで、まずは１つ１つの素子、パーセプロトンを見ていきます。</p>
<p>単一の素子は以下の図のように表され、入力を受け取り、</p>
<ul>
<li><strong>その値（の和）がある閾値 $\theta$ を超えたら発火して出力</strong></li>
<li><strong>$\theta$ 以下だったら出力しない</strong></li>
</ul>
<p>という性質を持ちます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="Perceptron" src="theme/img/NeuralNetworks/Perceptron.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>この性質を数学的に記述すると、</p>
<ul>
<li>重みパラメータ：$w_0,w_1,\ldots,w_m$</li>
<li>活性化関数：$h$</li>
</ul>
<p>から構成される以下のような関数として書けます。</p>
$$f(x_1,x_2,\ldots,x_m) = h(w_1x_1+w_2x_2+\cdots+w_Nx_N+w_0)$$<p>この時 $w_0$ は<font color="red"><b>バイアスパラメータ(bias parameter)</b></font>と呼ばれ、<b>関数を平行移動させる</b>役割を果たします。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="活性化関数(activation-function)">活性化関数(activation function)<a class="anchor-link" href="#活性化関数(activation-function)">¶</a></h3><p>活性化関数は、<font color="red"><b>「ある閾値 $\theta$ を超えたら発火して出力し、$\theta$ 以下だったら出力しない」</b></font>という神経の性質を表現するための関数であり、最も単純なものとしては以下で表される<b>ヘヴィサイド関数(Heaviside function)</b>があります。</p>
$$h(a) = \left\{\begin{array}{cc}0 & (\theta < 0) \\1 & (\theta > 0)\end{array}\right.$$<p>この性質は表したい能力を如実に表してはいますが、<b>不連続であり扱いづらい</b>ため、実際は</p>
<ul>
<li><b>ロジスティックシグモイド関数</b>：
$$h(a) = \frac{1}{1+\exp(-a)}\qquad(4.59)$$</li>
<li><b>ハイパボリックタンジェント関数</b>：
$$\begin{aligned}h(a) &= \tanh (a)\\&=\frac{e^a-e^{-1}}{e^1+e^{-1}}
&(5.59)\end{aligned}$$</li>
<li><b>ソフトマックス関数</b>：
$$h(\mathbf{a}) = \frac{\exp(a_i)}{\sum_j \exp(a_i)}\qquad (4.63)$$</li>
</ul>
<p>などが用いられることが多いです。</p>
<p>※ Kerasyでは<a href="https://github.com/iwasakishuto/Kerasy/blob/gh-pages/kerasy/activations.py">ここ</a>で定義しています。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [1]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Linear</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
        <span class="k">return</span> <span class="nb">input</span>
    
    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">dhda</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">dhda</span> 
    
<span class="k">class</span> <span class="nc">Tanh</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="nb">input</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
    
    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">a</span><span class="p">):</span>
        <span class="n">dhda</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">np</span><span class="o">.</span><span class="n">tanh</span><span class="p">(</span><span class="n">a</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">dhda</span>
    
<span class="n">ActivationHandler</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'linear'</span> <span class="p">:</span> <span class="n">Linear</span><span class="p">,</span>
    <span class="s1">'tanh'</span>   <span class="p">:</span> <span class="n">Tanh</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">ActivationFunc</span><span class="p">(</span><span class="n">activation_func_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">ActivationHandler</span><span class="p">[</span><span class="n">activation_func_name</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor2">2. 多層パーセプロトン (Multilayer Perceptron)</h2><p>それでは、複数の単子（単純パーセプロトン）を繋げて２層のパーセプトロンを作ります。なお、<b>２層以上のパーセプトロンを<font color="red">ニューラルネットワーク</font></b>と言います。</p>
<p>例えば１層目に $m$ 個の素子を用意し、入力が $D$ 次元の場合、関数で表すと</p>
$$y = h_2\left(\sum_{i=0}^{m} w^{(2)}_ih_1\left(\sum_{j=0}^{D}w^{(1)}_{ij} x_j\right)\right)\qquad(5.9)$$<p>となります。</p>
<p><img alt="Multilayer Perceptron" src="theme/img/NeuralNetworks/Multilayer-Perceptron.png" /></p>
<table>
<thead><tr>
<th style="text-align:center">記号</th>
<th style="text-align:left">意味</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">$w^{(1)}_{ij}$</td>
<td style="text-align:left">$1$ 層目の $i$ 番目の素子への入力 $x_j$ の重み</td>
</tr>
<tr>
<td style="text-align:center">$w^{(2)}_i$</td>
<td style="text-align:left">$1$ 層目の $i$ 番目の素子から $2$ 層目の素子への入力の重み</td>
</tr>
<tr>
<td style="text-align:center">$h_1,h_2$</td>
<td style="text-align:left">それぞれの層の活性化関数</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="多層にする意味">多層にする意味<a class="anchor-link" href="#多層にする意味">¶</a></h3><ul>
<li>単純パーセプロトン：
$$ y=f\left(\sum_i w_i\textcolor{red}{\phi_i(\mathbf{x})}\right) \qquad(5.1)$$</li>
<li>$2$ 層パーセプトロン：
$$ y = h_2\left(\sum_{i=0}^{m} w^{(2)}_i\textcolor{red}{h_1\left(\sum_{j=0}^{D}w^{(1)}_{ij} x_j\right)}\right)\qquad(5.9)$$</li>
</ul>
<p>この式から分かるように、基底 $\phi_i(\mathbf{x})$ が $\displaystyle h_1\left(\sum_{j=0}^{D}w^{(1)}_{ij} x_j\right)$ に置き換わっていることがわかります。</p>
<p>これによって、<font color="red"><b>単一だと「固定」されていた基底関数が、多層になることで「適応的に変動」する</b></font>ようになります。ゆえに、<b>十分大きな $m$ をとり、活性化関数が非線形な多層パーセプトロンは、<font color="red">任意の関数を任意の精度で近似することができる</font></b>という性質を持ちます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor3">3. 誤差逆伝播法 (Back Propagation)</h2><p>ニューラルネットワークについて語る上で避けては通れなく、理解が難しいのが<font color="red"><b>誤差逆伝播法（back propagation）</b></font>です。</p>
<p>しかし、誤差逆伝播法とは<b>「ニューラルネットワークを学習させる際に用いられる効率的な計算方法」</b>のことで、簡単に言ってしまえば<font color="red"><b>「合成関数の微分則」</b></font>です。また、ネットワークの訓練とは、<b>「（重みを変化させることで）訓練データの出力と正解の誤差 $E_n(\mathbf{w})$ を最小化すること」</b>を指します。</p>
<p>以下、</p>
<ul>
<li>素子 $i$ の出力を $z_i$</li>
<li>素子 $j$ への入力和を $a_j$</li>
</ul>
<p>として、説明します。</p>
<p>したがって、学習のプロセスにおいては<b>「素子 $i$ から素子 $j$ への接続の重み $w_{ji}$ として、全ての $i,j$ の組合せ（＝全ノードの重み）に対して$ \frac{\partial E_n}{\partial w_{ji}} $を計算すること」</b>が目標となります。</p>
<p><img alt="Back Propagation" src="theme/img/NeuralNetworks/BackPropagation1.png" /></p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>すると、上の図のように<b>「$E_n$ は $a_j$ を介してのみ $w_{ji}$ に依存する」（＝ $w_{ji}$ が変化すると $a_j$ が変化し、それが $E_n$ に影響を及ぼす）</b>ことに注意すれば</p>
$$ \frac{\partial E_n}{\partial w_{ji}} = \frac{\partial E_n}{\partial a_j}\frac{\partial a_j}{\partial w_{ji}}\qquad(5.50)$$<p>となります。また、ここで $\delta_j = \partial E_n/\partial a_j$ と書くことにし、これを<font color="red"><b>誤差</b></font>と呼びます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><img alt="Back Propagation2" src="theme/img/NeuralNetworks/BackPropagation2.png" /></p>
<p>続いて、$\delta_i$ について考えると、$E_n$ は素子 $i$ の出力を受け取る素子 $j$ の入力 $a_j$ を介して $a_i$ に依存するので、合成微分則より</p>
$$ \delta_i = \frac{\partial E_n}{\partial a_i} = \sum_j \frac{\partial E_n}{\partial a_j}\frac{\partial a_j}{\partial a_i} = \sum_j\delta_j\frac{\partial a_j}{\partial a_i}\qquad(5.55)$$<p>となります。（下図参照）</p>
<p><img alt="Back Propagation3" src="theme/img/NeuralNetworks/BackPropagation3.png" /></p>
<p>さらに、素子 $i$ の活性化関数を $h_i$ とすると、</p>
$$a_j = \sum_i w_{ji} h_i(a_i)\qquad(5.48)$$<p>だった（素子 $i$ への入力和を活性化関数に通しそれぞれに重み $w_{ji}$ をかけた和を素子 $j$ に伝える）ので、</p>
$$ \frac{\partial a_j}{\partial a_i} = w_{ji} h_i'(a_i)$$<p>となります。</p>
<p><img alt="Back Propagation4" src="theme/img/NeuralNetworks/BackPropagation4.png" /></p>
<p>ここまでをまとめると、誤差 $\delta_i$ の逆伝播公式</p>
$$ \delta_i = h_i'(a_i) \sum_j w_{ji}\delta_j\qquad(5.56)$$<p>が得られます。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>また、ネットワークの出力部における $\delta$ の値は直接計算する事が出来るので、そこから逆にネットワークを辿りながら各 $\delta$ を計算する事が可能になります。</p>
<p>このネットワークを逆に辿る過程で各 $w_{ji}$ に対する $W$ 個の偏導関数を一回の誤差伝播で求めてしまう事が出来るので、<b>効率の良いアルゴリズム</b>となっています。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="【まとめ】">【まとめ】<a class="anchor-link" href="#【まとめ】">¶</a></h3><ol>
<li>データ $\mathbf{x}_n$ を入力した時の、各素子への入力 $a_i$ 出力 $z_i$ を求める。<b>（順伝播）</b></li>
<li>ネットワークの出力部における誤差 $\delta_i$ を計算する。</li>
<li>逆伝播公式を利用して各素子における $\delta_i$ を計算する。
$$\delta_i = h_i'(a_i) \sum_j w_{ji}\delta_j$$</li>
<li>以下を利用して必要な偏微分係数を求める。
$$\frac{\partial E_n}{\partial w_{ji}} = \delta_j z_i$$</li>
</ol>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="anchor4">4. 実装 (Implementation)</h2>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [2]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="初期化">初期化<a class="anchor-link" href="#初期化">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [3]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">def</span> <span class="nf">Zeros</span><span class="p">(</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">RandomNormal</span><span class="p">(</span><span class="n">shape</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="n">shape</span><span class="p">)</span>

<span class="n">InitializeHandler</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'zeros'</span><span class="p">:</span> <span class="n">Zeros</span><span class="p">,</span>
    <span class="s1">'random_normal'</span><span class="p">:</span> <span class="n">RandomNormal</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">Initializer</span><span class="p">(</span><span class="n">initializer_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">InitializeHandler</span><span class="p">[</span><span class="n">initializer_name</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="誤差関数">誤差関数<a class="anchor-link" href="#誤差関数">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [4]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">mean_squared_error</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">loss</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">square</span><span class="p">(</span><span class="n">y_pred</span> <span class="o">-</span> <span class="n">y_true</span><span class="p">),</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">diff</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">y_pred</span><span class="p">):</span>
        <span class="k">return</span> <span class="n">y_pred</span><span class="o">-</span><span class="n">y_true</span>

<span class="n">LossHandler</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">'mean_squared_error'</span> <span class="p">:</span> <span class="n">mean_squared_error</span><span class="p">,</span>
<span class="p">}</span>

<span class="k">def</span> <span class="nf">LossFunc</span><span class="p">(</span><span class="n">loss_func_name</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">LossHandler</span><span class="p">[</span><span class="n">loss_func_name</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="各層">各層<a class="anchor-link" href="#各層">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [5]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Layers</span><span class="p">():</span>
    <span class="n">NLayers</span><span class="o">=</span><span class="mi">1</span>
    
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">units</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">f</span><span class="s2">"Layer</span><span class="si">{Layers.NLayers}</span><span class="s2">.</span><span class="si">{name}</span><span class="s2">"</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">outdim</span><span class="o">=</span><span class="n">units</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">Layers</span><span class="o">.</span><span class="n">NLayers</span><span class="o">+=</span><span class="mi">1</span>
        
    <span class="k">def</span> <span class="nf">build</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">indim</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">indim</span> <span class="o">=</span> <span class="n">indim</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">c_</span><span class="p">[</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdim</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">indim</span><span class="p">)),</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">outdim</span><span class="p">,</span><span class="mi">1</span><span class="p">))</span>
        <span class="p">]</span>

<span class="k">class</span> <span class="nc">Input</span><span class="p">(</span><span class="n">Layers</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputdim</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">"inputs"</span><span class="p">,</span> <span class="n">inputdim</span><span class="p">)</span>
        
<span class="k">class</span> <span class="nc">Dense</span><span class="p">(</span><span class="n">Layers</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">units</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s1">'linear'</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s1">'random_normal'</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s1">'zeros'</span><span class="p">):</span>
        <span class="sd">"""</span>
<span class="sd">        @param units             : (tuple) dimensionality of the (input space, output space).</span>
<span class="sd">        @param activation        : (str) Activation function to use.</span>
<span class="sd">        @param kernel_initializer: (str) Initializer for the `kernel` weights matrix.</span>
<span class="sd">        @param bias_initializer  : (str) Initializer for the bias vector.</span>
<span class="sd">        """</span>        
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="s2">"dense"</span><span class="p">,</span> <span class="n">units</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kernel_initializer</span> <span class="o">=</span> <span class="n">Initializer</span><span class="p">(</span><span class="n">kernel_initializer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias_initializer</span>   <span class="o">=</span> <span class="n">Initializer</span><span class="p">(</span><span class="n">bias_initializer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h</span> <span class="o">=</span> <span class="n">ActivationFunc</span><span class="p">(</span><span class="n">activation</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="kc">None</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
        <span class="sd">""" @param input: shape=(Din,) """</span>
        <span class="n">z_in</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">input</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span> <span class="c1"># shape=(Din+1,)            </span>
        <span class="n">a</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">z_in</span><span class="p">)</span>      <span class="c1"># (Dout,Din+1) @ (Din+1,) = (Dout,)</span>
        <span class="n">z_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="c1"># shape=(Dout,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="n">z_in</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">a</span>
        <span class="k">return</span> <span class="n">z_out</span>
    
    <span class="k">def</span> <span class="nf">backprop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dEdz_out</span><span class="p">):</span>
        <span class="sd">""" @param dEdz_out: shape=(Dout,) """</span>
        <span class="n">dEda</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">h</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">a</span><span class="p">)</span><span class="o">*</span><span class="n">dEdz_out</span> <span class="c1"># δ, shape=(Dout,)</span>
        <span class="n">dEdz_in</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">T</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">dEda</span><span class="p">)</span>        <span class="c1"># (Din+1,Dout) @ (Dout,) = (Din+1,)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">dEda</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">dEdz_in</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>                 <span class="c1"># shape=(Din,) term of bias is not propagated.</span>
    
    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">delta</span><span class="p">,</span> <span class="n">ALPHA</span><span class="o">=</span><span class="mf">0.01</span><span class="p">):</span>
        <span class="sd">""" @param delta: shape=(Dout,) """</span>
        <span class="n">dw</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">outer</span><span class="p">(</span><span class="n">delta</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">z</span><span class="p">)</span> <span class="c1"># (Dout,) × (Din+1,) = (Dout,Din+1)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">-=</span> <span class="n">ALPHA</span><span class="o">*</span><span class="n">dw</span> <span class="c1"># update. w → w + ALPHA*dw</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="モデル（各層のスタック）">モデル（各層のスタック）<a class="anchor-link" href="#モデル（各層のスタック）">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [6]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="k">class</span> <span class="nc">Sequential</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="n">layer</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="kc">None</span>
            
    <span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">layer</span><span class="p">):</span>
        <span class="sd">"""Adds a layer instance."""</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">layer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">compile</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">loss</span><span class="p">,</span> <span class="n">input_shape</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="sd">""" Creates the layer weights. """</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss</span> <span class="o">=</span> <span class="n">LossFunc</span><span class="p">(</span><span class="n">loss</span><span class="p">)</span>
        <span class="n">units</span> <span class="o">=</span> <span class="p">[</span><span class="n">l</span><span class="o">.</span><span class="n">outdim</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"inputs"</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">l</span><span class="o">.</span><span class="n">build</span><span class="p">(</span><span class="n">indim</span><span class="o">=</span><span class="n">units</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            
    <span class="k">def</span> <span class="nf">fit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">epochs</span><span class="o">=</span><span class="mi">1000</span><span class="p">):</span>
        <span class="n">goal_epochs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">+</span><span class="n">epochs</span>
        <span class="n">digit</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">goal_epochs</span><span class="p">))</span>
        <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">epochs</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">):</span>
                <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">y</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span><span class="o">+=</span><span class="mi">1</span>
            <span class="n">y_pred</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
            <span class="n">mse</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">y_pred</span><span class="o">-</span><span class="n">y_train</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">epochs</span> <span class="o">%</span> <span class="mi">100</span> <span class="o">==</span> <span class="mi">99</span><span class="p">:</span> <span class="nb">print</span><span class="p">(</span><span class="n">f</span><span class="s1">'[{self.epochs+1:</span><span class="si">{digit}</span><span class="s1">d}/{goal_epochs:</span><span class="si">{digit}</span><span class="s1">d}] mse={mse:</span><span class="si">{4}</span><span class="s1">f}'</span><span class="p">)</span>
        
    <span class="k">def</span> <span class="nf">forward</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="nb">input</span><span class="p">):</span>
        <span class="n">out</span><span class="o">=</span><span class="nb">input</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"inputs"</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">out</span><span class="o">=</span><span class="n">l</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>            
        <span class="k">return</span> <span class="n">out</span>
        
    <span class="k">def</span> <span class="nf">backprop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">y_true</span><span class="p">,</span> <span class="n">out</span><span class="p">):</span>
        <span class="n">dEdz_out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss</span><span class="o">.</span><span class="n">diff</span><span class="p">(</span><span class="n">y_true</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">reversed</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layers</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">name</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span> <span class="o">==</span> <span class="s2">"inputs"</span><span class="p">:</span> <span class="k">continue</span>
            <span class="n">dEdz_out</span> <span class="o">=</span> <span class="n">l</span><span class="o">.</span><span class="n">backprop</span><span class="p">(</span><span class="n">dEdz_out</span><span class="p">)</span>
                                                                                                       
    <span class="k">def</span> <span class="nf">predict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x_train</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">ndim</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span> 
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x_train</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">x_train</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="実装例">実装例<a class="anchor-link" href="#実装例">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [7]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">Sequential</span><span class="p">(</span><span class="n">Input</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"tanh"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">"random_normal"</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">"zeros"</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"tanh"</span><span class="p">,</span> <span class="n">kernel_initializer</span><span class="o">=</span><span class="s2">"random_normal"</span><span class="p">,</span> <span class="n">bias_initializer</span><span class="o">=</span><span class="s2">"zeros"</span><span class="p">))</span>
<span class="n">model</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">Dense</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="s2">"tanh"</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [8]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">"Units:   </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">outdim</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Layers:  </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">name</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Weights: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">w</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
<span class="n">model</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="n">loss</span><span class="o">=</span><span class="s2">"mean_squared_error"</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">"Weights: </span><span class="si">{}</span><span class="s2">"</span><span class="o">.</span><span class="n">format</span><span class="p">([</span><span class="n">l</span><span class="o">.</span><span class="n">w</span><span class="o">.</span><span class="n">shape</span> <span class="k">if</span> <span class="n">l</span><span class="o">.</span><span class="n">w</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="kc">None</span> <span class="k">for</span> <span class="n">l</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">layers</span><span class="p">]))</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>Units:   [1, 3, 3, 1]
Layers:  ['Layer1.inputs', 'Layer2.dense', 'Layer3.dense', 'Layer4.dense']
Weights: [None, None, None, None]
Weights: [None, (3, 2), (3, 4), (1, 4)]
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [9]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">N</span> <span class="o">=</span> <span class="mi">1000</span>
<span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span>
<span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">N</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="n">Y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vectorize</span><span class="p">(</span><span class="n">func</span><span class="p">)(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [10]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_subarea output_stream output_stdout output_text">
<pre>[ 100/1000] mse=0.027993
[ 200/1000] mse=0.007164
[ 300/1000] mse=0.001297
[ 400/1000] mse=0.000846
[ 500/1000] mse=0.000842
[ 600/1000] mse=0.000807
[ 700/1000] mse=0.000766
[ 800/1000] mse=0.000728
[ 900/1000] mse=0.000694
[1000/1000] mse=0.000664
</pre>
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [11]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">Y_pred</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">predict</span><span class="p">(</span><span class="n">X</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [12]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y_pred</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"Neural Network"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"red"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">Y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">"data"</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">"blue"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s2">"x"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">"y"</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="output_wrapper">
<div class="output">
<div class="output_area">
<div class="prompt"></div>
<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>
</div>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<style>
/*蛍光ペン(pink)*/
.marker-pink {
  color: #c45a5a;
  background: linear-gradient(transparent 70%, #ff66ff 60%);
  font-weight: bold;
}
/*蛍光ペン(blue) & hover info*/
.marker-info {
    color: #5C7DC4;
    background: linear-gradient(transparent 70%, #66FFCC 60%);
    font-weight: bold;
    position: relative;
    cursor: pointer;
}
.marker-info:hover:before {
    opacity: 1;
}
.marker-info:before {
  content: attr(aria-label);
  opacity: 0;
  position: absolute;
  top: 30px;
  right: -90px;
  font-size: 14px;
  width: 300px;
  padding: 10px;
  color: #fff;
  background-color: #555;
  border-radius: 3px;
  pointer-events: none;
}
</style>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
<div class="prompt input_prompt">In [ ]:</div>
<div class="inner_cell">
<div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span> 
</pre></div>
</div>
</div>
</div>
</div>

<script type="text/javascript">if (!document.getElementById('mathjaxscript_pelican_#%@#$@#')) {
    var mathjaxscript = document.createElement('script');
    mathjaxscript.id = 'mathjaxscript_pelican_#%@#$@#';
    mathjaxscript.type = 'text/javascript';
    mathjaxscript.src = '//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML';
    mathjaxscript[(window.opera ? "innerHTML" : "text")] =
        "MathJax.Hub.Config({" +
        "    config: ['MMLorHTML.js']," +
        "    TeX: { extensions: ['AMSmath.js','AMSsymbols.js','noErrors.js','noUndefined.js'], equationNumbers: { autoNumber: 'AMS' } }," +
        "    jax: ['input/TeX','input/MathML','output/HTML-CSS']," +
        "    extensions: ['tex2jax.js','mml2jax.js','MathMenu.js','MathZoom.js']," +
        "    displayAlign: 'center'," +
        "    displayIndent: '0em'," +
        "    showMathMenu: true," +
        "    tex2jax: { " +
        "        inlineMath: [ ['$','$'] ], " +
        "        displayMath: [ ['$$','$$'] ]," +
        "        processEscapes: true," +
        "        preview: 'TeX'," +
        "    }, " +
        "    'HTML-CSS': { " +
        "        styles: { '.MathJax_Display, .MathJax .mo, .MathJax .mi, .MathJax .mn': {color: 'black ! important'} }" +
        "    } " +
        "}); ";
    (document.body || document.getElementsByTagName('head')[0]).appendChild(mathjaxscript);
}
</script>
    
        </section>
    </div>
</div>
          </div>

          <footer class="show-for-large-up">
<div class="row">
    <div class="small-6 medium-3 columns">
        <ul class="left-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc">Home &nbsp;<i class="fa fa-home fa-fw"></i></a></li>
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/categories.html">Categories &nbsp;<i class="fa fa-folder-open fa-fw"></i></a></li>
        </ul>
    </div>
    <div class="small-6 medium-3 medium-push-6 columns">
        <ul class="right-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/archives.html"><i class="fa fa-archive fa-fw"></i>&nbsp; Archives</a></li>
        </ul>
    </div>
    <div class="small-12 medium-6 medium-pull-3 columns text-center">
        <p class="tag-cloud">
            <a href="https://iwasakishuto.github.io/Kerasy/doc/tags.html"><i class="fa fa-tags"></i>&nbsp;Tags:</a>&nbsp;&nbsp;
            &nbsp;&hellip;
        </p>
    </div>
    <div class="small-12 columns sub-footer">
        <hr>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-left">
                &copy; 2019 Shuto 
                <!-- <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="cc.png" /></a>-->
            </p>
        </div>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-right">
                Proudly powered by <a href="http://blog.getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
            </p>
        </div>
    </div>
</div>          </footer>
        </div>
      </div>


      <div class="row">
        <footer class="hide-for-large-up">
<div class="row">
    <div class="small-6 medium-3 columns">
        <ul class="left-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc">Home &nbsp;<i class="fa fa-home fa-fw"></i></a></li>
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/categories.html">Categories &nbsp;<i class="fa fa-folder-open fa-fw"></i></a></li>
        </ul>
    </div>
    <div class="small-6 medium-3 medium-push-6 columns">
        <ul class="right-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/archives.html"><i class="fa fa-archive fa-fw"></i>&nbsp; Archives</a></li>
        </ul>
    </div>
    <div class="small-12 medium-6 medium-pull-3 columns text-center">
        <p class="tag-cloud">
            <a href="https://iwasakishuto.github.io/Kerasy/doc/tags.html"><i class="fa fa-tags"></i>&nbsp;Tags:</a>&nbsp;&nbsp;
            &nbsp;&hellip;
        </p>
    </div>
    <div class="small-12 columns sub-footer">
        <hr>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-left">
                &copy; 2019 Shuto 
                <!-- <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="cc.png" /></a>-->
            </p>
        </div>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-right">
                Proudly powered by <a href="http://blog.getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
            </p>
        </div>
    </div>
</div>        </footer>
      </div>


      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/jquery.min.js"></script>
      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/foundation.min.js"></script>
      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/app.js"></script>
      <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
      <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/jupyter.css" media="screen">
    </body>

</html>