<!doctype html>
<html class="no-js" lang="en">
    <head>
        <link rel="shortcut icon" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" />

        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <meta name="author" content="Shuto" />
        <title>Kerasy</title>

        <meta name="description" content="Imitating to deepen my understanding of deep learning" />
        <meta name="keywords" content="Blog "/>

        <!--[if !IE 7]>
        <style type="text/css">
            #main-content {display:table;height:100%}
        </style>
        <![endif]-->
        <link rel="stylesheet" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/backdrop.css" />
        <link rel="stylesheet" href="https://iwasakishuto.github.io/Kerasy/doc/theme/css/pygments.css" />
        <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/modernizr.js"></script>

        <!-- Added by Shuto Iwasaki. -->
        <link rel="apple-touch-icon" sizes="152x152" href="https://iwasakishuto.github.io/images/apple-touch-icon/Kerasy.png" type="image/png" />
        <!-- Custom CSS -->
        <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/custom.css" media="screen">
        <!-- Syntax highlight -->
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/styles/github.min.css">
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/8.6/highlight.min.js"></script>
        <script>hljs.initHighlightingOnLoad();</script>
        <!-- LaTex -->
        <!-- Github env -->
        <!--<script type="text/javascript" async src="//cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-MML-AM_CHTML"></script>-->
        <script async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
        <script type="text/x-mathjax-config">
        	MathJax.Hub.Config({
        		tex2jax: {
        			inlineMath: [ ['$','$'], ["\\(","\\)"] ],
        			displayMath: [ ['$$','$$'], ["\\[","\\]"] ]
        		}
        	});
        </script>
        <script src="https://iwasakishuto.github.io/js/jquery.color.js"></script>
    </head>


    <body>
      <div class="master-row">

        <div class="image-pane main-content" style="background: url('https://iwasakishuto.github.io/Kerasy/doc/theme/img/background.png'); background-size:cover; background-position: right;">
          <div class="row">
            <div class="small-12 medium-4 large-12 columns">
              <h5 class='text-center'>About</h5>
              <div class="about-me">
                <div class="hide-for-medium-only small-3 columns no-buffer">
                  <a class="th" href="https://iwasakishuto.github.io/images/profile/square.png">
                    <img src="https://iwasakishuto.github.io/images/profile/square.png">
                  </a>
                </div>
                <div class="small-9 medium-12 large-9 columns text-justify">
                  Bioinformatics/Deep learning/Augmented Human/The University of Tokyo
                </div>
                <div class="small-12 columns">
                  <ul class="inline-center social-list">
                    <li><a href="https://twitter.com/cabernet_rock"><i class="fa fa-twitter"></i>&nbsp; twitter</a></li>
                    <li><a href="https://github.com/iwasakishuto"><i class="fa fa-github"></i>&nbsp; github</a></li>
                    <li><a href="https://www.facebook.com/iwasakishuto"><i class="fa fa-facebook"></i>&nbsp; facebook</a></li>
                  </ul>
                </div>
              </div>
            </div>

            <div class="small-12 medium-4  large-12 columns link-list">
              <h5 class='text-center'>Links</h5>
              <ul class="inline-center">
                <li><a href="https://iwasakishuto.github.io">Home</a></li>
                <li><a href="https://iwasakishuto.github.io/blog/articles/index.html">Blog</a></li>
                <li><a href="https://iwasakishuto.github.io/University/index.html">University</a></li>
                <li><a href="https://iwasakishuto.github.io/Kerasy/doc/index.html">Kerasy</a></li>
                <li><a href="https://iwasakishuto.github.io/Front-End/index.html">Front-End</a></li>
              </ul>
            </div>

<!--
            <div class="small-12 medium-3 large-12 columns">
            </div>
-->
          </div>
        </div>

        <div class="content-pane main-content">
          <nav class="top-bar" data-topbar role="navigation">
            <ul class="title-area">
              <li class="name"><!-- Leave this empty --></li>
              <li class="toggle-topbar menu-icon"><a href="#"><span></span></a></li>
            </ul>
            <section class="top-bar-section">
              <ul class="left">
              </ul>
              <ul class="right">
                <li><a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></li>
              </ul>
            </section>
          </nav>

          <div class="row title-bar">
            <div class="small-12 columns">
              <h1><a href="https://iwasakishuto.github.io/Kerasy/doc">Kerasy</a></h1>
              <h2> <small>Imitating to deepen my understanding of deep learning</small></h2>
              <hr>
            </div>
          </div>

          <div id="contents">
<div class="row">
    <div class="small-12 medium-12 columns">
        <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/CNN.html" rel="bookmark" title="Permalink to CNN">CNN</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-30(金)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="CNN:-Convolutional-Neural-Network">CNN: Convolutional Neural Network<a class="anchor-link" href="#CNN:-Convolutional-Neural-Network">¶</a></h1><p><strong>（編集中）</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/CNN.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>
    </div>
    <div class="small-12 medium-6 columns small-articles">
        <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/Initializers.html" rel="bookmark" title="Permalink to Initializers">Initializers</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-28(水)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="初期化(Initializers)">初期化(Initializers)<a class="anchor-link" href="#初期化(Initializers)">¶</a></h1><p><strong>（編集中）</strong></p>
</div>
</div>
</div>
<div class="cell border-box-sizing code_cell rendered">
<div class="input">
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/Initializers.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>
    </div>
    <div class="small-12 medium-6 columns small-articles">
        <section class="summary">
    <h3><a href="https://iwasakishuto.github.io/Kerasy/doc/Optimizers.html" rel="bookmark" title="Permalink to Optimizers">Optimizers</a></h3>
    <div class="row info-bar" style="margin-left:0rem;margin-bottom:6px;">
    <div class="small-12 columns">
        <ul class="inline-list">
            <li><span><i class="fa fa-calendar"></i>&nbsp; 2019-08-26(月)</span></li>
            <li><span><i class="fa fa-folder-open"></i>&nbsp; <a href="https://iwasakishuto.github.io/Kerasy/doc/category/kerasy.html">Kerasy</a></span></li>
            <li>
                <span>
                    <i class="fa fa-tags"></i>&nbsp;
                    <a href="https://iwasakishuto.github.io/Kerasy/doc/tag/kerasy.html"><span class="label">Kerasy</span></a>
                </span>
            </li>
        </ul>
    </div>
</div>
    <div class="row summary">
        <div class="small-12 medium-12 columns">
            <div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="最適化(Optimization)">最適化(Optimization)<a class="anchor-link" href="#最適化(Optimization)">¶</a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>機械学習では、モデルを定義し、重みパラメータを調整して損失関数の値を減少させることで、性能を高めます。</p>
<p>この時、<b>「いつ」</b>・<b>「どのようにして」</b>・<b>「どのぐらい」</b>重みパラメータを調整するのか、を決めるのが <code>optimizers</code> の役割です。</p>
<p>ここでは、最適化の基本である<span class="marker-pink">勾配降下法(Gradient Decent)</span>のパラメータ更新方法を見ていき、その後勾配降下法の欠点を修正した様々な最適化手法を紹介します。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="勾配降下法(Gradient-Decent)">勾配降下法(Gradient Decent)<a class="anchor-link" href="#勾配降下法(Gradient-Decent)">¶</a></h2><p><a href="http://www.deepideas.net/deep-learning-from-scratch-iv-gradient-descent-and-backpropagation/"><img src="http://www.deepideas.net/wp-content/uploads/2017/08/gradient_descent.png" /></a></p>
<p>勾配降下法は非常に単純なアイデアで、損失関数の<span class="marker-pink">勾配ベクトル（最も傾きが急な方向）</span>に注目し、その逆方向に進めば関数の最小値にたどり着くことができるだろう、というものです。</p>
<p>更新式は以下のようになります。</p>
$$\mathbf{w} \leftarrow \mathbf{w} - \eta \frac{\partial E}{\partial \mathbf{w}}$$<p>この時、$\eta$ は<span class="marker-pink">学習率</span>と呼ばれ、どの程度勾配を下るかを決めるパラメータです。</p>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="$\eta$-と学習の関係">$\eta$ と学習の関係<a class="anchor-link" href="#$\eta$-と学習の関係">¶</a></h3>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="prompt input_prompt">
</div><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>$\eta$ の値を変化させた時にどのように値が変化するかを、二乗和誤差 $E(\mathbf{w}) = \left\|\mathbf{y} - \mathbf{X}\mathbf{w}\right\|^2$ に対する線形回帰の場合で見ていきます。</p>
<p>この時、損失関数の勾配ベクトルは以下によって求まります。</p>
$$
\begin{aligned}
  \frac{\partial}{\partial \mathbf{w}}E(\mathbf{w}) 
  &= \frac{\partial}{\partial \mathbf{w}}\left\|\mathbf{y} - \mathbf{X}\mathbf{w}\right\|^2\\
  &= \frac{\partial}{\partial \mathbf{w}}\left( \left\|\mathbf{y}\right\|^2 -2\mathbf{w}^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{y} + \|\mathbf{Xw}\|^2\right)\\
  &= -2\mathbf{X}^{\mathrm{T}}\mathbf{y} + \frac{\partial}{\partial \mathbf{w}}\left(\left(\mathbf{Xw}\right)^{\mathrm{T}}\left(\mathbf{Xw}\right)\right)\\
  &= -2\mathbf{X}^{\mathrm{T}}\mathbf{y} + \frac{\partial}{\partial \mathbf{w}}\left(\mathbf{w}^{\mathrm{T}}\mathbf{X}^{\mathrm{T}}\mathbf{Xw}\right)\\
  &= -2\mathbf{X}^{\mathrm{T}}\mathbf{y} + \left(\mathbf{X}^{\mathrm{T}}\mathbf{X} + \left(\mathbf{X}^{\mathrm{T}}\mathbf{X}\right)^{\mathrm{T}}\right)\mathbf{w}\\
  &= 2\mathbf{X}^{\mathrm{T}}\left(\mathbf{Xw} - \mathbf{y}\right)
\end{aligned}
$$
</div>
            <p class='text-right'><a href="https://iwasakishuto.github.io/Kerasy/doc/Optimizers.html">Continue reading&hellip;</a></p>
        </div>
    </div>
</section>
    </div>
</div>
<div class="row">
    <div class="small-12 columns">
        <a class="button" href="https://iwasakishuto.github.io/Kerasy/doc/archives.html">Older Articles&hellip;</a>
    </div>
</div>
          </div>

          <footer class="show-for-large-up">
<div class="row">
    <div class="small-6 medium-3 columns">
        <ul class="left-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc">Home &nbsp;<i class="fa fa-home fa-fw"></i></a></li>
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/categories.html">Categories &nbsp;<i class="fa fa-folder-open fa-fw"></i></a></li>
        </ul>
    </div>
    <div class="small-6 medium-3 medium-push-6 columns">
        <ul class="right-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/archives.html"><i class="fa fa-archive fa-fw"></i>&nbsp; Archives</a></li>
        </ul>
    </div>
    <div class="small-12 medium-6 medium-pull-3 columns text-center">
        <p class="tag-cloud">
            <a href="https://iwasakishuto.github.io/Kerasy/doc/tags.html"><i class="fa fa-tags"></i>&nbsp;Tags:</a>&nbsp;&nbsp;
            &nbsp;&hellip;
        </p>
    </div>
    <div class="small-12 columns sub-footer">
        <hr>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-left">
                &copy; 2019 Shuto 
                <!-- <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="cc.png" /></a>-->
            </p>
        </div>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-right">
                Proudly powered by <a href="http://blog.getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
            </p>
        </div>
    </div>
</div>          </footer>
        </div>
      </div>


      <div class="row">
        <footer class="hide-for-large-up">
<div class="row">
    <div class="small-6 medium-3 columns">
        <ul class="left-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc">Home &nbsp;<i class="fa fa-home fa-fw"></i></a></li>
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/categories.html">Categories &nbsp;<i class="fa fa-folder-open fa-fw"></i></a></li>
        </ul>
    </div>
    <div class="small-6 medium-3 medium-push-6 columns">
        <ul class="right-nav">
            <li><a href="https://iwasakishuto.github.io/Kerasy/doc/archives.html"><i class="fa fa-archive fa-fw"></i>&nbsp; Archives</a></li>
        </ul>
    </div>
    <div class="small-12 medium-6 medium-pull-3 columns text-center">
        <p class="tag-cloud">
            <a href="https://iwasakishuto.github.io/Kerasy/doc/tags.html"><i class="fa fa-tags"></i>&nbsp;Tags:</a>&nbsp;&nbsp;
            &nbsp;&hellip;
        </p>
    </div>
    <div class="small-12 columns sub-footer">
        <hr>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-left">
                &copy; 2019 Shuto 
                <!-- <a rel="license" href="https://creativecommons.org/licenses/by-nc-sa/4.0/"><img alt="Creative Commons License" style="border-width:0" src="cc.png" /></a>-->
            </p>
        </div>
        <div class="small-12 medium-6 columns">
            <p class="small-text-center medium-text-right">
                Proudly powered by <a href="http://blog.getpelican.com/">Pelican</a>,
                which takes great advantage of <a href="https://www.python.org/">Python</a>.
            </p>
        </div>
    </div>
</div>        </footer>
      </div>


      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/jquery.min.js"></script>
      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/foundation.min.js"></script>
      <script src="https://iwasakishuto.github.io/Kerasy/doc/theme/js/app.js"></script>
      <script src="https://iwasakishuto.github.io/js/smooth-scroll.polyfills.min.js"></script>
      <link rel="stylesheet" type="text/css" href="https://iwasakishuto.github.io/css/jupyter.css" media="screen">
    </body>

</html>